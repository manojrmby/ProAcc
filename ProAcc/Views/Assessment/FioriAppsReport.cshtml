
@{
    ViewBag.Title = "FioriAppsReport";
    Layout = "~/Views/shared/_Layout.cshtml";
}

<h2>FioriAppsReport</h2>

<script src="~/Asset/Scripts/Chart.js"></script>
<script src="~/Asset/Scripts/Chart.RadialGauge.umd.js"></script>
<script src="~/Asset/Scripts/chartjs-plugin-labels.min.js"></script>
<div style="padding:1em;">
	<div class="row">
		<div class="col-md-12 card" id="Chart123">
			<div class="row" style="padding:0em 1em 1em 1em;">
				<div class="col-lg-6">
					<a>SimplificationReport</a>
				</div>
				<div class="col-lg-6">

					@Html.DropDownList("Roles", (IEnumerable<SelectListItem>)ViewBag.Roles, "ALL", new { id = "IDRoles", @class = "form-control" })
				</div>
			</div>

		</div>
		<canvas id="Chart_FioriApps"></canvas>
	</div>
    
    <div class="row">
        <div class="col-lg-12 card" style="min-height:600px;">
            <h4>
                Show Database value in DataTable
            </h4>
			<div class="tableFixHead outer table-striped">
				<table>
					<thead>
						<tr>
							<th>S.NO</th>
							<th>Role</th>
							<th>Name</th>
							<th>Application Area</th>
							<th>Description</th>
						</tr>

					</thead>
					<tbody>
						@foreach (var item in ViewBag.FiRReport)
						{

						<tr>
							<td class="text-center">
								@item.S_No.
							</td>
							<td>
								@item.Role
							</td>
							<td>
								@item.Name
							</td>
							<td>
								@item.Application_Area
							</td>
							<td>
								@item.Description
							</td>

						</tr>
						}
					</tbody>
				</table>
			</div>
            
        </div>
    </div>
</div>

<script type="text/javascript" charset="utf-8">

    function renderChart(data, labels) {
        $("canvas#Chart_FioriApps").remove();

		$("#Chart123").append('<canvas id="Chart_FioriApps" class="animated fadeIn" height="150"></canvas>');
		var ctx = document.getElementById("Chart_FioriApps").getContext("2d");

		//var randomScalingFactor = function () {
		//	return Math.round(Math.random() * 100);
		//};


		var maxval = Math.max.apply(Math, data);

		Chart.defaults.global.defaultFontFamily = "Verdana";
		var config = {
			//type: "horizontalBar",
			type: "bar",

			data: {
				labels: labels,
				datasets: [
					{

                        data: data,
						backgroundColor: [
                            '#FF6384',
                            '#36A2EB',
                            '#FFCE56',
							'#FF6384',
                            '#36A2EB',
                            '#FFCE56',
							'#FF6384',
                            '#36A2EB',
                            '#FFCE56',
							'#FF6384',
                            '#36A2EB',
                            '#FFCE56'
                        ],
						
					}
				]
			},
			options: {

				responsive: true,
				legend: {
					display: false
				},
				title: {
					display: false,
					text: "Radial gauge chart"
				},
				centerPercentage: 60,
				centerArea: {
					displayText: true,
					text: "100%"
                },
				plugins: {
                    labels: {
                        render: 'value'
                    }
                },

				//animation: {
				//		duration:5000
				//},
                scales: {
                    xAxes: [{
                        ticks: {
                            display: false,//this will remove only the label
                            beginAtZero: true
                        },
                        gridLines: {
                            display: false,
                            drawBorder: true,

                        }
                    }],
                    yAxes: [{
                        display: false,

                        ticks: {
							beginAtZero: true,
                            steps: 10,
                            stepValue: 5,
							//stepSize:.5,
                            max: maxval +5
                        }
                    }]


                }
			}
		};
		window.myRadialGauge = new Chart(ctx, config);

	}

	function Ajax_Call(a) {

		$.ajax({
			type: "POST",
			url: '@Url.Action("GetFioriAppsReportt_Bar")',
			data: '{Input: ' + JSON.stringify(a) + '}',
			dataType: "json",
			contentType: "application/json; charset=utf-8",
			success: function (Data) {

				var Output = Data._List;

				var inpName = []; var inpVal = []; var backColor = [];
				for (var i = 0; i < Output.length; i++) {
					inpName.push(Output[i].Name);
					inpVal.push(Output[i]._Value);
					//backColor.push()
				}
				labels = inpName;
				data_ = inpVal;
				renderChart(data_, labels);

			},
			error: function () {
				alert("Error while inserting data");
			}
		}).done(function (response) {
			//chart.data = response;

		});
	}






	jQuery(document).ready(function ($) {

		var a = $('#IDRoles option:selected').text();
		Ajax_Call(a);


	});
	$("#IDRoles").change(function () {

		var a = $('#IDRoles option:selected').text();

		Ajax_Call(a);

	   });
</script>